## 06월 21일 학습내용

- ServerLess Framework (lambda)
- 내가 만든 서버를 iam에게 요청하여 배포

### AWS Credentials 만들기
1. IAM 사용자 추가.
   1. 사용자 이름: flask_app_user
   2. 권한옵션 직접정책연결 ( 아래 목록들 **체크** )
      - AmazonAPIGatewayAdministrator
      - AmazonRDSDateFullAccess
      - CloudFrontFullAccess
      - IAMFullAccess
      - CloudWatchFullAccess
      - AmzonS3FullAccess
      - AWSCloudFormationFullAccess
      - AWSLambda_FullAccess
2. 생성-> 사용자 정보-> 보안 자격 증명
   - 액세스 키 만들기
   - 로컬코드-> 하단 동의(체크)-> 다음-> 태그 안써도 됨-> 다음
   - 억세스키 생성 됨, 다운ㄱㄱ, csv(필수) 없으면 접근 권한 없음.
3. ServerLess Framework 접속 및 설치
   - Docs-> Framework(Documetation)->Get Started->Setup->install in first
   - 18.16.1 LTS 다운로드-> 설치(Default Setting install)
   - 시작-> AnacondaPrompt 실행
```
$npm install -g serverless 
서버리스 프로그램을 설치하는 것
```
   - 서버리스 로그인-> CreateApp-> python flask API 선택-> aws-recipe-app 생성
   - 생성하면 나오는 코드를 복사 혹은 메모해둔다.(하단에 있는 코드)  
```
$npm i -g serverless && serverless \
--org=the9world \
--app=aws-recipe-app \
--name=aws-recipe-app \
--template=aws-python-flask-api
```
   - Anaconda Prompt 실행(관리자X)  
아까 위에서 aws-recipe-app 생성 후 나온 코드에서  
"\\"(백슬래시) 지우고 줄 바꿈하여 코드를 한 줄로 바꿔서 입력·실행
   ```
   $cd documents/Github
   $npm i -g serverless && serverless --org=the9world --app=aws-recipe-app --name=aws-recipe-app --template=aws-python-flask-api
   ```
   - 위 코드 입력 후 완료 되면 홈페이지가 접속된다.
   - org-> provides-> add-> Access/Secret Keys(액세스키 csv 등록)  
Name: flask_app_user (AWS IAM에서 만든 사용자명)  
AWS Access KEY: (csv 파일의 Access key ID)  
AWS Secret KEY: (csv 파일의 Secret access key)  
다 입력 했으면 [Create AWS provider] 클릭
   - AnacondaPrompt로 돌아와서 아래 코드를 입력한다.
   ```
   $cd documents/Github
   $cd aws-recipe-app
   $sls deploy
   ```
   - 위 $sls deploy 명령어 입력할 때 마다 코드가 배포?  
dashboard: https://app.serverless.com/the9world/apps/aws-recipe-app/aws-recipe-app/dev/us-east-1  
endpoint: ANY - https://vzwxr43m7f.execute-api.us-east-1.amazonaws.com  
프롬프트에 나오는 주소들 중 endpoint가 배포되는 주소  
(교수님 github에 API서버 파일에 설명 참조)

---
### 배포 관련 확인
- vscode실행->파일-> 폴더 열기-> aws-recipe-app 폴더 선택
- app.py 파일에 명령어들이 아까 했던 endpoint에 출력 되는 것들.

### Test 하기
- createApp-> aws-test-app
```
npm i -g serverless && serverless \
    --org=the9world \
    --app=aws-test-app \
    --name=aws-test-app \
    --template=aws-python-flask-api

serverless --org=the9world --app=aws-test-app --name=aws-test-app --template=aws-python-flask-api
첫 줄 "npm i -g serverless"는 설치니까 지우고 한 줄로 변경
```
- 프롬프트에서 경로 GitHub로 이동하여 위 코드 입력하고 (Y) 입력